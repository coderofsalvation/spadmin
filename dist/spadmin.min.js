!function(t,e,r,n){"use strict";function a(t,e){for(var r=0,n=t.length;n>r;r++)b(t[r],e)}function i(t){for(var e,r=0,n=t.length;n>r;r++)e=t[r],N(e,U[u(e)])}function l(t){return function(e){nt(e)&&(b(e,t),a(e.querySelectorAll(H),t))}}function u(t){var e=t.getAttribute("is"),r=t.nodeName.toUpperCase(),n=Z.call(S,e?_+e.toUpperCase():R+r);return e&&n>-1&&!o(r,e)?-1:n}function o(t,e){return-1<H.indexOf(t+'[is="'+e+'"]')}function c(t){var e=t.currentTarget,r=t.attrChange,n=t.attrName,a=t.target;pt&&(!a||a===e)&&e.attributeChangedCallback&&"style"!==n&&t.prevValue!==t.newValue&&e.attributeChangedCallback(n,r===t[M]?null:t.prevValue,r===t[V]?null:t.newValue)}function s(t){var e=l(t);return function(t){m.push(e,t.target)}}function d(t){vt&&(vt=!1,t.currentTarget.removeEventListener(D,d)),a((t.target||e).querySelectorAll(H),t.detail===L?L:w),rt&&v()}function f(t,e){var r=this;lt.call(r,t,e),g.call(r,{target:r})}function h(t,e){Q(t,e),E?E.observe(t,ct):(ht&&(t.setAttribute=f,t[y]=C(t),t.addEventListener(P,g)),t.addEventListener(I,c)),t.createdCallback&&pt&&(t.created=!0,t.createdCallback(),t.created=!1)}function v(){for(var t,e=0,r=at.length;r>e;e++)t=at[e],x.contains(t)||(r--,at.splice(e--,1),b(t,L))}function p(t){throw new Error("A "+t+" type is already registered")}function b(t,e){var r,n=u(t);n>-1&&(O(t,U[n]),n=0,e!==w||t[w]?e===L&&!t[L]&&(t[w]=!1,t[L]=!0,n=1):(t[L]=!1,t[w]=!0,n=1,rt&&Z.call(at,t)<0&&at.push(t)),n&&(r=t[e+"Callback"])&&r.call(t))}if(!(n in e)){var m,g,A,C,E,O,N,y="__"+n+(1e5*Math.random()>>0),w="attached",L="detached",T="extends",M="ADDITION",F="MODIFICATION",V="REMOVAL",I="DOMAttrModified",D="DOMContentLoaded",P="DOMSubtreeModified",R="<",_="=",k=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,q=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],S=[],U=[],H="",x=e.documentElement,Z=S.indexOf||function(t){for(var e=this.length;e--&&this[e]!==t;);return e},G=r.prototype,j=G.hasOwnProperty,z=G.isPrototypeOf,K=r.defineProperty,W=r.getOwnPropertyDescriptor,X=r.getOwnPropertyNames,Y=r.getPrototypeOf,$=r.setPrototypeOf,B=!!r.__proto__,J=r.create||function bt(t){return t?(bt.prototype=t,new bt):this},Q=$||(B?function(t,e){return t.__proto__=e,t}:X&&W?function(){function t(t,e){for(var r,n=X(e),a=0,i=n.length;i>a;a++)r=n[a],j.call(t,r)||K(t,r,W(e,r))}return function(e,r){do t(e,r);while((r=Y(r))&&!z.call(r,e));return e}}():function(t,e){for(var r in e)t[r]=e[r];return t}),tt=t.MutationObserver||t.WebKitMutationObserver,et=(t.HTMLElement||t.Element||t.Node).prototype,rt=!z.call(et,x),nt=rt?function(t){return 1===t.nodeType}:function(t){return z.call(et,t)},at=rt&&[],it=et.cloneNode,lt=et.setAttribute,ut=et.removeAttribute,ot=e.createElement,ct=tt&&{attributes:!0,characterData:!0,attributeOldValue:!0},st=tt||function(t){ht=!1,x.removeEventListener(I,st)},dt=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(t){setTimeout(t,10)},ft=!1,ht=!0,vt=!0,pt=!0;$||B?(O=function(t,e){z.call(e,t)||h(t,e)},N=h):(O=function(t,e){t[y]||(t[y]=r(!0),h(t,e))},N=O),rt?(ht=!1,function(){var t=W(et,"addEventListener"),e=t.value,r=function(t){var e=new CustomEvent(I,{bubbles:!0});e.attrName=t,e.prevValue=this.getAttribute(t),e.newValue=null,e[V]=e.attrChange=2,ut.call(this,t),this.dispatchEvent(e)},n=function(t,e){var r=this.hasAttribute(t),n=r&&this.getAttribute(t),a=new CustomEvent(I,{bubbles:!0});lt.call(this,t,e),a.attrName=t,a.prevValue=r?n:null,a.newValue=e,r?a[F]=a.attrChange=1:a[M]=a.attrChange=0,this.dispatchEvent(a)},a=function(t){var e,r=t.currentTarget,n=r[y],a=t.propertyName;n.hasOwnProperty(a)&&(n=n[a],e=new CustomEvent(I,{bubbles:!0}),e.attrName=n.name,e.prevValue=n.value||null,e.newValue=n.value=r[a]||null,null==e.prevValue?e[M]=e.attrChange=0:e[F]=e.attrChange=1,r.dispatchEvent(e))};t.value=function(t,i,l){t===I&&this.attributeChangedCallback&&this.setAttribute!==n&&(this[y]={className:{name:"class",value:this.className}},this.setAttribute=n,this.removeAttribute=r,e.call(this,"propertychange",a)),e.call(this,t,i,l)},K(et,"addEventListener",t)}()):tt||(x.addEventListener(I,st),x.setAttribute(y,1),x.removeAttribute(y),ht&&(g=function(t){var e,r,n,a=this;if(a===t.target){e=a[y],a[y]=r=C(a);for(n in r){if(!(n in e))return A(0,a,n,e[n],r[n],M);if(r[n]!==e[n])return A(1,a,n,e[n],r[n],F)}for(n in e)if(!(n in r))return A(2,a,n,e[n],r[n],V)}},A=function(t,e,r,n,a,i){var l={attrChange:t,currentTarget:e,attrName:r,prevValue:n,newValue:a};l[i]=t,c(l)},C=function(t){for(var e,r,n={},a=t.attributes,i=0,l=a.length;l>i;i++)e=a[i],r=e.name,"setAttribute"!==r&&(n[r]=e.value);return n})),e[n]=function(t,r){if(n=t.toUpperCase(),ft||(ft=!0,tt?(E=function(t,e){function r(t,e){for(var r=0,n=t.length;n>r;e(t[r++]));}return new tt(function(n){for(var a,i,l,u=0,o=n.length;o>u;u++)a=n[u],"childList"===a.type?(r(a.addedNodes,t),r(a.removedNodes,e)):(i=a.target,pt&&i.attributeChangedCallback&&"style"!==a.attributeName&&(l=i.getAttribute(a.attributeName),l!==a.oldValue&&i.attributeChangedCallback(a.attributeName,a.oldValue,l)))})}(l(w),l(L)),E.observe(e,{childList:!0,subtree:!0})):(m=[],dt(function g(){for(;m.length;)m.shift().call(null,m.shift());dt(g)}),e.addEventListener("DOMNodeInserted",s(w)),e.addEventListener("DOMNodeRemoved",s(L))),e.addEventListener(D,d),e.addEventListener("readystatechange",d),e.createElement=function(t,r){var n=ot.apply(e,arguments),a=""+t,i=Z.call(S,(r?_:R)+(r||a).toUpperCase()),l=i>-1;return r&&(n.setAttribute("is",r=r.toLowerCase()),l&&(l=o(a.toUpperCase(),r))),pt=!e.createElement.innerHTMLHelper,l&&N(n,U[i]),n},et.cloneNode=function(t){var e=it.call(this,!!t),r=u(e);return r>-1&&N(e,U[r]),t&&i(e.querySelectorAll(H)),e}),-2<Z.call(S,_+n)+Z.call(S,R+n)&&p(t),!k.test(n)||-1<Z.call(q,n))throw new Error("The type "+t+" is invalid");var n,c,f=function(){return v?e.createElement(b,n):e.createElement(b)},h=r||G,v=j.call(h,T),b=v?r[T].toUpperCase():n;return v&&-1<Z.call(S,R+b)&&p(b),c=S.push((v?_:R)+n)-1,H=H.concat(H.length?",":"",v?b+'[is="'+t.toLowerCase()+'"]':b),f.prototype=U[c]=j.call(h,"prototype")?h.prototype:J(et),a(e.querySelectorAll(H),w),f}}}(window,document,Object,"registerElement"); bus=function(){this.channels=[],this._state="normal",this.debug=!1},bus.prototype.state=function(t){return t?(this._state=t,void this.publish("state",t)):this._state},bus.prototype.publish=function(t,s,e){e&&this.state(e),this.debug&&(console.log("--> bus.publish('"+t+"') state="+this._state),s&&console.dir(s));var n=this;(this.channels[t]||[]).map(function(t){t(s,n._state)})},bus.prototype.subscribe=function(t,s){return(this.channels[t]=this.channels[t]||[]).push(s),[t,s]},bus.prototype.unsubscribe=function(t){for(var s=this.channels[t[0]],e=s.length;e--;)s[e]===t[1]&&s.splice(e,1)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=bus:window.bus=bus; !function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.page=e()}}(function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var p=n[a]={exports:{}};t[a][0].call(p.exports,function(e){var n=t[a][1][e];return i(n?n:e)},p,p.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){(function(n){"use strict";function r(e,t){if("function"==typeof e)return r("*",e);if("function"==typeof t)for(var n=new s(e),i=1;i<arguments.length;++i)r.callbacks.push(n.middleware(arguments[i]));else"string"==typeof e?r["string"==typeof t?"redirect":"show"](e,t):r.start(e)}function i(e){if(!e.handled){var t;t=y?g+v.hash.replace("#!",""):v.pathname+v.search,t!==e.canonicalPath&&(r.stop(),e.handled=!1,v.href=e.canonicalPath)}}function o(e){return"string"!=typeof e?e:m?decodeURIComponent(e.replace(/\+/g," ")):e}function a(e,t){"/"===e[0]&&0!==e.indexOf(g)&&(e=g+(y?"#!":"")+e);var n=e.indexOf("?");if(this.canonicalPath=e,this.path=e.replace(g,"")||"/",y&&(this.path=this.path.replace("#!","")||"/"),this.title=document.title,this.state=t||{},this.state.path=e,this.querystring=~n?o(e.slice(n+1)):"",this.pathname=o(~n?e.slice(0,n):e),this.params={},this.hash="",!y){if(!~this.path.indexOf("#"))return;var r=this.path.split("#");this.path=r[0],this.hash=o(r[1])||"",this.querystring=this.querystring.split("#")[0]}}function s(e,t){t=t||{},this.path="*"===e?"(.*)":e,this.method="GET",this.regexp=f(this.path,this.keys=[],t)}function u(e){if(1===c(e)&&!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){for(var t=e.path?e.path[0]:e.target;t&&"A"!==t.nodeName;)t=t.parentNode;if(t&&"A"===t.nodeName&&!t.hasAttribute("download")&&"external"!==t.getAttribute("rel")){var i=t.getAttribute("href");if((y||t.pathname!==v.pathname||!t.hash&&"#"!==i)&&!(i&&i.indexOf("mailto:")>-1)&&!t.target&&p(t.href)){var o=t.pathname+t.search+(t.hash||"");"undefined"!=typeof n&&o.match(/^\/[a-zA-Z]:\//)&&(o=o.replace(/^\/[a-zA-Z]:\//,"/"));var a=o;0===o.indexOf(g)&&(o=o.substr(g.length)),y&&(o=o.replace("#!","")),g&&a===o||(e.preventDefault(),r.show(a))}}}}function c(e){return e=e||window.event,null===e.which?e.button:e.which}function p(e){var t=v.protocol+"//"+v.hostname;return v.port&&(t+=":"+v.port),e&&0===e.indexOf(t)}var f=e("path-to-regexp");t.exports=r;var h,d,l="undefined"!=typeof document&&document.ontouchstart?"touchstart":"click",v="undefined"!=typeof window&&(window.history.location||window.location),w=!0,m=!0,g="",y=!1;r.callbacks=[],r.exits=[],r.current="",r.len=0,r.base=function(e){return 0===arguments.length?g:void(g=e)},r.start=function(e){if(e=e||{},!h&&(h=!0,!1===e.dispatch&&(w=!1),!1===e.decodeURLComponents&&(m=!1),!1!==e.popstate&&window.addEventListener("popstate",x,!1),!1!==e.click&&document.addEventListener(l,u,!1),!0===e.hashbang&&(y=!0),w)){var t=y&&~v.hash.indexOf("#!")?v.hash.substr(2)+v.search:v.pathname+v.search+v.hash;r.replace(t,null,!0,w)}},r.stop=function(){h&&(r.current="",r.len=0,h=!1,document.removeEventListener(l,u,!1),window.removeEventListener("popstate",x,!1))},r.show=function(e,t,n,i){var o=new a(e,t);return r.current=o.path,!1!==n&&r.dispatch(o),!1!==o.handled&&!1!==i&&o.pushState(),o},r.back=function(e,t){r.len>0?(history.back(),r.len--):e?setTimeout(function(){r.show(e,t)}):setTimeout(function(){r.show(g,t)})},r.redirect=function(e,t){"string"==typeof e&&"string"==typeof t&&r(e,function(e){setTimeout(function(){r.replace(t)},0)}),"string"==typeof e&&"undefined"==typeof t&&setTimeout(function(){r.replace(e)},0)},r.replace=function(e,t,n,i){var o=new a(e,t);return r.current=o.path,o.init=n,o.save(),!1!==i&&r.dispatch(o),o},r.dispatch=function(e){function t(){var e=r.exits[s++];return e?void e(o,t):n()}function n(){var t=r.callbacks[a++];return e.path!==r.current?void(e.handled=!1):t?void t(e,n):i(e)}var o=d,a=0,s=0;d=e,o?t():n()},r.exit=function(e,t){if("function"==typeof e)return r.exit("*",e);for(var n=new s(e),i=1;i<arguments.length;++i)r.exits.push(n.middleware(arguments[i]))},r.Context=a,a.prototype.pushState=function(){r.len++,history.pushState(this.state,this.title,y&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},a.prototype.save=function(){history.replaceState(this.state,this.title,y&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},r.Route=s,s.prototype.middleware=function(e){var t=this;return function(n,r){return t.match(n.path,n.params)?e(n,r):void r()}},s.prototype.match=function(e,t){var n=this.keys,r=e.indexOf("?"),i=~r?e.slice(0,r):e,a=this.regexp.exec(decodeURIComponent(i));if(!a)return!1;for(var s=1,u=a.length;u>s;++s){var c=n[s-1],p=o(a[s]);void 0===p&&hasOwnProperty.call(t,c.name)||(t[c.name]=p)}return!0};var x=function(){var e=!1;if("undefined"!=typeof window)return"complete"===document.readyState?e=!0:window.addEventListener("load",function(){setTimeout(function(){e=!0},0)}),function(t){if(e)if(t.state){var n=t.state.path;r.replace(n,t.state)}else r.show(v.pathname+v.hash,void 0,void 0,!1)}}();r.sameOrigin=p}).call(this,e("_process"))},{_process:2,"path-to-regexp":3}],2:[function(e,t,n){function r(){}var i=t.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var r=[];if(t){var i=document.createElement("div"),o=new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})});return o.observe(i,{attributes:!0}),function(e){r.length||i.setAttribute("yes","no"),r.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],3:[function(e,t,n){function r(e){for(var t,n=[],r=0,i=0,o="";null!=(t=w.exec(e));){var a=t[0],u=t[1],c=t.index;if(o+=e.slice(i,c),i=c+a.length,u)o+=u[1];else{o&&(n.push(o),o="");var p=t[2],f=t[3],h=t[4],d=t[5],l=t[6],v=t[7],m="+"===l||"*"===l,g="?"===l||"*"===l,y=p||"/",x=h||d||(v?".*":"[^"+y+"]+?");n.push({name:f||r++,prefix:p||"",delimiter:y,optional:g,repeat:m,pattern:s(x)})}}return i<e.length&&(o+=e.substr(i)),o&&n.push(o),n}function i(e){return o(r(e))}function o(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^"+e[n].pattern+"$"));return function(n){for(var r="",i=n||{},o=0;o<e.length;o++){var a=e[o];if("string"!=typeof a){var s,u=i[a.name];if(null==u){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to be defined')}if(v(u)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but received "'+u+'"');if(0===u.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var c=0;c<u.length;c++){if(s=encodeURIComponent(u[c]),!t[o].test(s))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'", but received "'+s+'"');r+=(0===c?a.prefix:a.delimiter)+s}}else{if(s=encodeURIComponent(u),!t[o].test(s))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but received "'+s+'"');r+=a.prefix+s}}else r+=a}return r}}function a(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function s(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function c(e){return e.sensitive?"":"i"}function p(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return u(e,t)}function f(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(l(e[i],t,n).source);var o=new RegExp("(?:"+r.join("|")+")",c(n));return u(o,t)}function h(e,t,n){for(var i=r(e),o=d(i,n),a=0;a<i.length;a++)"string"!=typeof i[a]&&t.push(i[a]);return u(o,t)}function d(e,t){t=t||{};for(var n=t.strict,r=t.end!==!1,i="",o=e[e.length-1],s="string"==typeof o&&/\/$/.test(o),u=0;u<e.length;u++){var p=e[u];if("string"==typeof p)i+=a(p);else{var f=a(p.prefix),h=p.pattern;p.repeat&&(h+="(?:"+f+h+")*"),h=p.optional?f?"(?:"+f+"("+h+"))?":"("+h+")?":f+"("+h+")",i+=h}}return n||(i=(s?i.slice(0,-2):i)+"(?:\\/(?=$))?"),i+=r?"$":n&&s?"":"(?=\\/|$)",new RegExp("^"+i,c(t))}function l(e,t,n){return t=t||[],v(t)?n||(n={}):(n=t,t=[]),e instanceof RegExp?p(e,t,n):v(e)?f(e,t,n):h(e,t,n)}var v=e("isarray");t.exports=l,t.exports.parse=r,t.exports.compile=i,t.exports.tokensToFunction=o,t.exports.tokensToRegExp=d;var w=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},{isarray:4}],4:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}]},{},[1])(1)}); !function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.superagent=t()}}(function(){return function t(e,r,i){function n(o,a){if(!r[o]){if(!e[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return n(r?r:t)},c,c.exports,t,e,r,i)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(t,e,r){function i(t){return null!==t&&"object"==typeof t}e.exports=i},{}],2:[function(t,e,r){var i=t("./is-object");r.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},r.parse=function(t){return this._parser=t,this},r.serialize=function(t){return this._serializer=t,this},r.timeout=function(t){return this._timeout=t,this},r.then=function(t,e){if(!this._fullfilledPromise){var r=this;this._fullfilledPromise=new Promise(function(t,e){r.end(function(r,i){r?e(r):t(i)})})}return this._fullfilledPromise.then(t,e)},r.use=function(t){return t(this),this},r.get=function(t){return this._header[t.toLowerCase()]},r.getHeader=r.get,r.set=function(t,e){if(i(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},r.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},r.field=function(t,e){return this._getFormData().append(t,e),this},r.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},r.withCredentials=function(){return this._withCredentials=!0,this},r.redirects=function(t){return this._maxRedirects=t,this},r.toJSON=function(){return{method:this.method,url:this.url,data:this._data}},r._isHost=function(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}},r.send=function(t){var e=i(t),r=this._header["content-type"];if(e&&i(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this._header["content-type"],"application/x-www-form-urlencoded"==r?this._data=this._data?this._data+"&"+t:t:this._data=(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(r||this.type("json"),this)}},{"./is-object":1}],3:[function(t,e,r){function i(t,e,r){return"function"==typeof r?new t("GET",e).end(r):2==arguments.length?new t("GET",e):new t(e,r)}e.exports=i},{}],4:[function(t,e,r){function i(t){return t?n(t):void 0}function n(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}"undefined"!=typeof e&&(e.exports=i),i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},i.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i,n=0;n<r.length;n++)if(i=r[n],i===e||i.fn===e){r.splice(n,1);break}return this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r){r=r.slice(0);for(var i=0,n=r.length;n>i;++i)r[i].apply(this,e)}return this},i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],5:[function(t,e,r){e.exports=function(t,e,r){for(var i=0,n=t.length,s=3==arguments.length?r:t[i++];n>i;)s=e.call(null,s,t[i],++i,t);return s}},{}],6:[function(t,e,r){function i(){}function n(t){if(!b(t))return t;var e=[];for(var r in t)null!=t[r]&&s(e,r,t[r]);return e.join("&")}function s(t,e,r){if(Array.isArray(r))return r.forEach(function(r){s(t,e,r)});if(b(r))for(var i in r)s(t,e+"["+i+"]",r[i]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}function o(t){for(var e,r,i={},n=t.split("&"),s=0,o=n.length;o>s;++s)e=n[s],r=e.indexOf("="),-1==r?i[decodeURIComponent(e)]="":i[decodeURIComponent(e.slice(0,r))]=decodeURIComponent(e.slice(r+1));return i}function a(t){var e,r,i,n,s=t.split(/\r?\n/),o={};s.pop();for(var a=0,u=s.length;u>a;++a)r=s[a],e=r.indexOf(":"),i=r.slice(0,e).toLowerCase(),n=w(r.slice(e+1)),o[i]=n;return o}function u(t){return/[\/+]json\b/.test(t)}function h(t){return t.split(/ *; */).shift()}function c(t){return m(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),i=r.shift(),n=r.shift();return i&&n&&(t[i]=n),t},{})}function l(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function p(t,e){var r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new l(r)}catch(i){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=i,t.rawResponse=r.xhr&&r.xhr.responseText?r.xhr.responseText:null,t.statusCode=r.xhr&&r.xhr.status?r.xhr.status:null,r.callback(t)}if(r.emit("response",e),t)return r.callback(t,e);try{if(e.status>=200&&e.status<300)return r.callback(t,e);var n=new Error(e.statusText||"Unsuccessful HTTP response");n.original=t,n.response=e,n.status=e.status,r.callback(n,e)}catch(i){r.callback(i)}})}function f(t,e){var r=v("DELETE",t);return e&&r.end(e),r}var d,y=t("emitter"),m=t("reduce"),_=t("./request-base"),b=t("./is-object");d="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var v=e.exports=t("./request").bind(null,p);v.getXHR=function(){if(!(!d.XMLHttpRequest||d.location&&"file:"==d.location.protocol&&d.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1};var w="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};v.serializeObject=n,v.parseString=o,v.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},v.serialize={"application/x-www-form-urlencoded":n,"application/json":JSON.stringify},v.parse={"application/x-www-form-urlencoded":o,"application/json":JSON.parse},l.prototype.get=function(t){return this.header[t.toLowerCase()]},l.prototype._setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=h(e);var r=c(e);for(var i in r)this[i]=r[i]},l.prototype._parseBody=function(t){var e=v.parse[this.type];return!e&&u(this.type)&&(e=v.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null},l.prototype._setStatusProperties=function(t){1223===t&&(t=204);var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},l.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,i="cannot "+e+" "+r+" ("+this.status+")",n=new Error(i);return n.status=this.status,n.method=e,n.url=r,n},v.Response=l,y(p.prototype);for(var x in _)p.prototype[x]=_[x];p.prototype.type=function(t){return this.set("Content-Type",v.types[t]||t),this},p.prototype.responseType=function(t){return this._responseType=t,this},p.prototype.accept=function(t){return this.set("Accept",v.types[t]||t),this},p.prototype.auth=function(t,e,r){switch(r||(r={type:"basic"}),r.type){case"basic":var i=btoa(t+":"+e);this.set("Authorization","Basic "+i);break;case"auto":this.username=t,this.password=e}return this},p.prototype.query=function(t){return"string"!=typeof t&&(t=n(t)),t&&this._query.push(t),this},p.prototype.attach=function(t,e,r){return this._getFormData().append(t,e,r||e.name),this},p.prototype._getFormData=function(){return this._formData||(this._formData=new d.FormData),this._formData},p.prototype.callback=function(t,e){var r=this._callback;this.clearTimeout(),r(t,e)},p.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},p.prototype._timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},p.prototype._appendQueryString=function(){var t=this._query.join("&");t&&(this.url+=~this.url.indexOf("?")?"&"+t:"?"+t)},p.prototype.end=function(t){var e=this,r=this.xhr=v.getXHR(),n=this._timeout,s=this._formData||this._data;this._callback=t||i,r.onreadystatechange=function(){if(4==r.readyState){var t;try{t=r.status}catch(i){t=0}if(0==t){if(e.timedout)return e._timeoutError();if(e._aborted)return;return e.crossDomainError()}e.emit("end")}};var o=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),t.direction="download",e.emit("progress",t)};this.hasListeners("progress")&&(r.onprogress=o);try{r.upload&&this.hasListeners("progress")&&(r.upload.onprogress=o)}catch(a){}if(n&&!this._timer&&(this._timer=setTimeout(function(){e.timedout=!0,e.abort()},n)),this._appendQueryString(),this.username&&this.password?r.open(this.method,this.url,!0,this.username,this.password):r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof s&&!this._isHost(s)){var h=this._header["content-type"],c=this._serializer||v.serialize[h?h.split(";")[0]:""];!c&&u(h)&&(c=v.serialize["application/json"]),c&&(s=c(s))}for(var l in this.header)null!=this.header[l]&&r.setRequestHeader(l,this.header[l]);return this._responseType&&(r.responseType=this._responseType),this.emit("request",this),r.send("undefined"!=typeof s?s:null),this},v.Request=p,v.get=function(t,e,r){var i=v("GET",t);return"function"==typeof e&&(r=e,e=null),e&&i.query(e),r&&i.end(r),i},v.head=function(t,e,r){var i=v("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&i.send(e),r&&i.end(r),i},v.options=function(t,e,r){var i=v("OPTIONS",t);return"function"==typeof e&&(r=e,e=null),e&&i.send(e),r&&i.end(r),i},v.del=f,v["delete"]=f,v.patch=function(t,e,r){var i=v("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&i.send(e),r&&i.end(r),i},v.post=function(t,e,r){var i=v("POST",t);return"function"==typeof e&&(r=e,e=null),e&&i.send(e),r&&i.end(r),i},v.put=function(t,e,r){var i=v("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&i.send(e),r&&i.end(r),i}},{"./is-object":1,"./request":3,"./request-base":2,emitter:4,reduce:5}]},{},[6])(6)}); !function t(e,n,r){function i(s,u){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!u&&l)return l(s,!0);if(o)return o(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return i(n?n:t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r,i,o,s,u,l=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};s=t("../lib/lodash.js"),u=t("./helpers"),i=t("./context"),o={},o.render=function(t,e,n,r){var l,a;return null==e&&(e=[]),null==n&&(n={}),null==r&&(r={}),a=r.debug&&console?u.consoleLogger:u.nullLogger,a("Transparency.render:",t,e,n,r),t?(s.isArray(e)||(e=[e]),t=(l=u.data(t)).context||(l.context=new i(t,o)),t.render(e,n,r).el):void 0},o.matcher=function(t,e){return t.el.id===e||l.call(t.classNames,e)>=0||t.el.name===e||t.el.getAttribute("data-bind")===e},o.clone=function(t){return r(t).clone()[0]},o.jQueryPlugin=u.chainable(function(t,e,n){var r,i,s,u;for(u=[],i=0,s=this.length;s>i;i++)r=this[i],u.push(o.render(r,t,e,n));return u}),("undefined"!=typeof jQuery&&null!==jQuery||"undefined"!=typeof Zepto&&null!==Zepto)&&(r=jQuery||Zepto,null!=r&&(r.fn.render=o.jQueryPlugin)),("undefined"!=typeof e&&null!==e?e.exports:void 0)&&(e.exports=o),"undefined"!=typeof window&&null!==window&&(window.Transparency=o),("undefined"!=typeof define&&null!==define?define.amd:void 0)&&define(function(){return o})},{"../lib/lodash.js":7,"./context":3,"./helpers":5}],2:[function(t,e,n){var r,i,o,s,u,l,a,h,c=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=t("../lib/lodash"),h=t("./helpers"),e.exports=i={Attributes:{},createAttribute:function(t,e){var n;return new(n=i.Attributes[e]||r)(t,e)}},r=function(){function t(t,e){this.el=t,this.name=e,this.templateValue=this.el.getAttribute(this.name)||""}return t.prototype.set=function(t){return this.el[this.name]=t,this.el.setAttribute(this.name,t.toString())},t}(),o=function(t){function e(t,e){this.el=t,this.name=e,this.templateValue=this.el.getAttribute(this.name)||!1}var n,r,o,s;for(c(e,t),n=["hidden","async","defer","autofocus","formnovalidate","disabled","autofocus","formnovalidate","multiple","readonly","required","checked","scoped","reversed","selected","loop","muted","autoplay","controls","seamless","default","ismap","novalidate","open","typemustmatch","truespeed"],r=0,o=n.length;o>r;r++)s=n[r],i.Attributes[s]=e;return e.prototype.set=function(t){return this.el[this.name]=t,t?this.el.setAttribute(this.name,this.name):this.el.removeAttribute(this.name)},e}(r),l=function(t){function e(t,e){var n;this.el=t,this.name=e,this.templateValue=function(){var t,e,r,i;for(r=this.el.childNodes,i=[],t=0,e=r.length;e>t;t++)n=r[t],n.nodeType===h.TEXT_NODE&&i.push(n.nodeValue);return i}.call(this).join(""),this.children=a.toArray(this.el.children),(this.textNode=this.el.firstChild)?this.textNode.nodeType!==h.TEXT_NODE&&(this.textNode=this.el.insertBefore(this.el.ownerDocument.createTextNode(""),this.textNode)):this.el.appendChild(this.textNode=this.el.ownerDocument.createTextNode(""))}return c(e,t),i.Attributes.text=e,e.prototype.set=function(t){for(var e,n,r,i,o;e=this.el.firstChild;)this.el.removeChild(e);for(this.textNode.nodeValue=t,this.el.appendChild(this.textNode),i=this.children,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.el.appendChild(e));return o},e}(r),u=function(t){function e(t){this.el=t,this.templateValue="",this.children=a.toArray(this.el.children)}return c(e,t),i.Attributes.html=e,e.prototype.set=function(t){for(var e,n,r,i,o;e=this.el.firstChild;)this.el.removeChild(e);for(this.el.innerHTML=t+this.templateValue,i=this.children,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.el.appendChild(e));return o},e}(r),s=function(t){function e(t){e.__super__.constructor.call(this,t,"class")}return c(e,t),i.Attributes["class"]=e,e}(r)},{"../lib/lodash":7,"./helpers":5}],3:[function(t,e,n){var r,i,o,s,u,l,a;a=t("./helpers"),s=a.before,o=a.after,u=a.chainable,l=a.cloneNode,i=t("./instance"),e.exports=r=function(){function t(t,e){this.el=t,this.Transparency=e,this.template=l(this.el),this.instances=[new i(this.el,this.Transparency)],this.instanceCache=[]}var e,n;return n=u(function(){return this.parent=this.el.parentNode,this.parent?(this.nextSibling=this.el.nextSibling,this.parent.removeChild(this.el)):void 0}),e=u(function(){return this.parent?this.nextSibling?this.parent.insertBefore(this.el,this.nextSibling):this.parent.appendChild(this.el):void 0}),t.prototype.render=s(n)(o(e)(u(function(t,e,n){for(var r,o,s,u,a,h,c;t.length<this.instances.length;)this.instanceCache.push(this.instances.pop().remove());for(;t.length>this.instances.length;)u=this.instanceCache.pop()||new i(l(this.template),this.Transparency),this.instances.push(u.appendTo(this.el));for(c=[],s=o=0,a=t.length;a>o;s=++o)h=t[s],u=this.instances[s],r=[],c.push(u.prepare(h,r).renderValues(h,r).renderDirectives(h,s,e).renderChildren(h,r,e,n));return c}))),t}()},{"./helpers":5,"./instance":6}],4:[function(t,e,n){var r,i,o,s,u,l,a,h,c,p,f,d={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("../lib/lodash.js"),f=t("./helpers"),r=t("./attributeFactory"),e.exports=s={Elements:{input:{}},createElement:function(t){var e,n;return new(e="input"===(n=t.nodeName.toLowerCase())?s.Elements[n][t.type.toLowerCase()]||u:s.Elements[n]||o)(t)}},o=function(){function t(t){this.el=t,this.attributes={},this.childNodes=p.toArray(this.el.childNodes),this.nodeName=this.el.nodeName.toLowerCase(),this.classNames=this.el.className.split(" "),this.originalAttributes={}}return t.prototype.empty=function(){for(var t;t=this.el.firstChild;)this.el.removeChild(t);return this},t.prototype.reset=function(){var t,e,n,r;n=this.attributes,r=[];for(e in n)t=n[e],r.push(t.set(t.templateValue));return r},t.prototype.render=function(t){return this.attr("text",t)},t.prototype.attr=function(t,e){var n,i;return n=(i=this.attributes)[t]||(i[t]=r.createAttribute(this.el,t,e)),null!=e&&n.set(e),n},t.prototype.renderDirectives=function(t,e,n){var r,i,o,s;o=[];for(i in n)d.call(n,i)&&(r=n[i],"function"==typeof r&&(s=r.call(t,{element:this.el,index:e,value:this.attr(i).templateValue}),null!=s?o.push(this.attr(i,s)):o.push(void 0)));return o},t}(),a=function(t){function e(t){e.__super__.constructor.call(this,t),this.elements=f.getElements(t)}return y(e,t),s.Elements.select=e,e.prototype.render=function(t){var e,n,r,i,o;for(t=t.toString(),i=this.elements,o=[],e=0,n=i.length;n>e;e++)r=i[e],"option"===r.nodeName&&o.push(r.attr("selected",r.el.value===t));return o},e}(o),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var n,r,i,o;for(y(e,t),n=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],r=0,i=n.length;i>r;r++)o=n[r],s.Elements[o]=e;return e.prototype.attr=function(t,n){return"text"!==t&&"html"!==t?e.__super__.attr.call(this,t,n):void 0},e}(o),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.render=function(t){return this.attr("value",t)},e}(c),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),s.Elements.textarea=e,e}(u),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),s.Elements.input.checkbox=e,e.prototype.render=function(t){return this.attr("checked",Boolean(t))},e}(u),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),s.Elements.input.radio=e,e}(i)},{"../lib/lodash.js":7,"./attributeFactory":2,"./helpers":5}],5:[function(t,e,n){var r,i,o,s;r=t("./elementFactory"),n.before=function(t){return function(e){return function(){return t.apply(this,arguments),e.apply(this,arguments)}}},n.after=function(t){return function(e){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}},n.chainable=n.after(function(){return this}),n.onlyWith$=function(t){return"undefined"!=typeof jQuery&&null!==jQuery||"undefined"!=typeof Zepto&&null!==Zepto?function(e){return t(arguments)}(jQuery||Zepto):void 0},n.getElements=function(t){var e;return e=[],i(t,e),e},i=function(t,e){var o,s;for(o=t.firstChild,s=[];o;)o.nodeType===n.ELEMENT_NODE&&(e.push(new r.createElement(o)),i(o,e)),s.push(o=o.nextSibling);return s},n.ELEMENT_NODE=1,n.TEXT_NODE=3,s=function(){return"<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML},n.cloneNode="undefined"==typeof document||null===document||s()?function(t){return t.cloneNode(!0)}:function(t){var e,r,i,s,u;if(e=Transparency.clone(t),e.nodeType===n.ELEMENT_NODE)for(e.removeAttribute(o),u=e.getElementsByTagName("*"),i=0,s=u.length;s>i;i++)r=u[i],r.removeAttribute(o);return e},o="transparency",n.data=function(t){return t[o]||(t[o]={})},n.nullLogger=function(){},n.consoleLogger=function(){return console.log(arguments)},n.log=n.nullLogger},{"./elementFactory":4}],6:[function(t,e,n){var r,i,o,s,u={}.hasOwnProperty;i=t("../lib/lodash.js"),o=(s=t("./helpers")).chainable,e.exports=r=function(){function t(t,e){this.Transparency=e,this.queryCache={},this.childNodes=i.toArray(t.childNodes),this.elements=s.getElements(t)}return t.prototype.remove=o(function(){var t,e,n,r,i;for(r=this.childNodes,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(n.parentNode.removeChild(n));return i}),t.prototype.appendTo=o(function(t){var e,n,r,i,o;for(i=this.childNodes,o=[],e=0,n=i.length;n>e;e++)r=i[e],o.push(t.appendChild(r));return o}),t.prototype.prepare=o(function(t){var e,n,r,i,o;for(i=this.elements,o=[],n=0,r=i.length;r>n;n++)e=i[n],e.reset(),o.push(s.data(e.el).model=t);return o}),t.prototype.renderValues=o(function(t,e){var n,r,o,s;if(i.isElement(t)&&(n=this.elements[0]))return n.empty().el.appendChild(t);if("object"==typeof t){o=[];for(r in t)u.call(t,r)&&(s=t[r],null!=s&&(i.isString(s)||i.isNumber(s)||i.isBoolean(s)||i.isDate(s)?o.push(function(){var t,e,i,o;for(i=this.matchingElements(r),o=[],t=0,e=i.length;e>t;t++)n=i[t],o.push(n.render(s));return o}.call(this)):"object"==typeof s?o.push(e.push(r)):o.push(void 0)));return o}}),t.prototype.renderDirectives=o(function(t,e,n){var r,i,o,s;s=[];for(o in n)u.call(n,o)&&(r=n[o],"object"==typeof r&&("object"!=typeof t&&(t={value:t}),s.push(function(){var n,s,u,l;for(u=this.matchingElements(o),l=[],n=0,s=u.length;s>n;n++)i=u[n],l.push(i.renderDirectives(t,e,r));return l}.call(this))));return s}),t.prototype.renderChildren=o(function(t,e,n,r){var i,o,s,u,l;for(l=[],o=0,u=e.length;u>o;o++)s=e[o],l.push(function(){var e,o,u,l;for(u=this.matchingElements(s),l=[],e=0,o=u.length;o>e;e++)i=u[e],l.push(this.Transparency.render(i.el,t[s],n[s],r));return l}.call(this));return l}),t.prototype.matchingElements=function(t){var e,n,r;return r=(e=this.queryCache)[t]||(e[t]=function(){var e,r,i,o;for(i=this.elements,o=[],e=0,r=i.length;r>e;e++)n=i[e],this.Transparency.matcher(n,t)&&o.push(n);return o}.call(this)),s.log("Matching elements for '"+t+"':",r),r},t}()},{"../lib/lodash.js":7,"./helpers":5}],7:[function(t,e,n){var r={};r.toString=Object.prototype.toString,r.toArray=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n];return e},r.isString=function(t){return"[object String]"==r.toString.call(t)},r.isNumber=function(t){return"[object Number]"==r.toString.call(t)},r.isArray=Array.isArray||function(t){return"[object Array]"===r.toString.call(t)},r.isDate=function(t){return"[object Date]"===r.toString.call(t)},r.isElement=function(t){return!(!t||1!==t.nodeType)},r.isPlainValue=function(t){var e;return e=typeof t,"object"!==e&&"function"!==e||n.isDate(t)},r.isBoolean=function(t){return t===!0||t===!1},e.exports=r},{}]},{},[1]); !function(e){"use strict";function t(){var e=document.getElementById("nanobarcss");if(null===e){if(e=document.createElement("style"),e.type="text/css",e.id="nanobarcss",document.head.insertBefore(e,document.head.firstChild),!e.styleSheet)return e.appendChild(document.createTextNode(a));e.styleSheet.cssText=a}}function n(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function i(e){function t(){var t=s-d;.1>t&&t>-.1?(i(d),r=0,100===s&&(a.style.height=0,setTimeout(function(){e(a)},300))):(i(s-t/4),setTimeout(o,16))}function i(e){s=e,a.style.width=s+"%"}function o(e){e>=0?(d=e,r||(r=1,t())):r&&t()}var a=document.createElement("div"),s=0,d=0,r=0,c={el:a,go:o};return n(a,"bar"),c}function o(e){function o(e){d.removeChild(e)}function a(){var e=i(o);d.appendChild(e.el),s=e.go}e=e||{};var s,d=document.createElement("div"),r={el:d,go:function(e){s(e),100===e&&a()}};return t(),n(d,"nanobar"),e.id&&(d.id=e.id),e.classname&&n(d,e.classname),e.target?(d.style.position="relative",e.target.insertBefore(d,e.target.firstChild)):(d.style.position="fixed",document.getElementsByTagName("body")[0].appendChild(d)),a(),r}var a=".nanobar{width:100%;height:4px;z-index:9999;top:0}.bar{width:0;height:100%;transition:height .3s;background:#000}";"object"==typeof exports?module.exports=o:"function"==typeof define&&define.amd?define([],function(){return o}):e.Nanobar=o}(this); var Spadmin=function(){console.log("*TODO* add typeshave"),this.channels={},this.page=page,this.template=Transparency,this.loader=new Nanobar,this.bus=new bus,this.request=window.superagent};Spadmin.prototype.init=function(t){this.bus=new bus,t.debug&&(this.bus.debug=!0),t.sandbox&&(this.sandbox=sandbox),this.bus.publish("init",arguments,"loading"),this.opts=t,this.pageid=t.content.replace(/^#/g,""),this.api=new api(t.apiurl,this),this.bus.publish("init/post",arguments)},Spadmin.prototype.renderPage=function(t,e){this.bus.publish("renderpage/pre",arguments),this.update(this.pageid,{show:!1}),this.render(t,e,this.pageid),this.update(this.pageid,{show:!0}),this.bus.publish("renderpage/post",arguments)},Spadmin.prototype.renderDOM=function(t,e,r,n){this.bus.publish("renderdom/pre",arguments);var i=t;if(r&&(i=document.getElementById(r),!i))throw"cannot find domid #"+r;this.template.render(t,e[0]||e,e[1]||{}),r&&(i.innerHTML=t.innerHTML),this.executeScripts(t),n&&n(t,arguments),this.bus.publish("renderdom/post",arguments)},Spadmin.prototype.executeScripts=function(el){for(var codes=el.getElementsByTagName("script"),i=0;i<codes.length;i++)codes[i].text&&eval(codes[i].text),codes[i].src&&this.loadScript(codes[i].src)},Spadmin.prototype.loadScript=function(t){this.bus.publish("loadscript",arguments);var e=document.createElement("script");e.src=t,e.async=!1,e.type="text/javascript",document.body.appendChild(e)},Spadmin.prototype.renderHTML=function(t,e){this.bus.publish("renderhtml/post",arguments);try{var r=document.createElement("div");return r.innerHTML=t.innerHTML,this.template.render(r,e[0]||e,e[1]||{}),this.bus.publish("renderhtml/post",r),r.innerHTML}catch(n){console.dir({args:arguments,func:"spadmin.renderHTML",error:n})}},Spadmin.prototype.render=function(t,e,r,n){this.bus.publish("render",arguments);try{var i=null!=t.match(/^http/)||null!=t.match(/\//),o=null!=t.match(/^#/);void 0!=r&&r.length&&(r=r.replace(/^#/,""));var p=this;if(o){var s=document.getElementById(t.replace(/^#/,""));this.renderDOM(s,e,r,n)}else i?superagent.get(t).end(function(t,i){if(t){if(String(t).match(/Error:/))throw t;return p.bus.publish("error",{type:"server",data:{err:t,res:i}})}var o=document.createElement("div");o.innerHTML=i.text,p.renderDOM(o,e,r,n)}):this.renderDOM(s,e,r,n)}catch(u){console.dir({args:arguments,func:"spadmin.render",error:u})}},Spadmin.prototype.update=function(t,e){this.bus.publish("update",arguments,"loading"),e&&void 0!=e.show&&(e.show===!1&&this.loader.go(50),e.show===!0&&this.loader.go(100)),this.bus.publish("update/post",arguments),this.bus.state("normal")};var fp=function(){};fp.prototype.compose=function(){var t;t=1<=arguments.length?[].slice.call(arguments,0):[];var e=t.reverse().reduce(function(t,e){return function(){var r;return r=1<=arguments.length?[].slice.call(arguments,0):[],t(e.apply(null,r))}});return e},fp.prototype.ncurry=function(t,e,r){return null==r&&(r=[]),function(){var n;return n=1<=arguments.length?[].slice.call(arguments,0):[],n=r.concat(n),n.length<t?fp.prototype.ncurry(t,e,n):e.apply(null,n)}},fp.prototype.eq=function(t,e){return curry(function(t,e,r){return t==r||t==pick(e)(r)?r:void 0})(t)(e)},fp.prototype.curry=function(t){return me=this,function(){var e;return e=1<=arguments.length?[].slice.call(arguments,0):[],t.length>e.length?fp.prototype.ncurry(t.length,t,e):t.apply(null,e)}},fp.prototype.pick=fp.prototype.curry(function(t,e){return String(t).split(".").reduce(function(t,r){return null!=t?(fp.prototype.debug&&console.log("-- spadmin.fp.pick("+r+","+e+")"),t[r]):void 0},e)}),fp.prototype.createEventStream=function(t,e,r){var n="string"==typeof e?[e]:e,i=function(e){function r(t,r){r.map(function(r){t.addEventListener(r,e)})}var i,o;if("#"!==t[0]){var o=document.querySelectorAll(t);return Array.prototype.forEach.call(o,function(t){r(t,n)}),o}return(i=document.querySelector(t))?(r(i,n),i):void 0};return i},fp.prototype.mapAsync=function(t,e,r){var n,i,o,p,s;i=[],o=0;for(p in t)s=t[p],n=function(t,r){return function(){var n,o;try{return cb(r,t,i[t+1]||e)}catch(o){return n=o,e(new Error(n))}}},i.push(n(o++,s));return i[0]()},fp.prototype.delay=function(t,e){return fp.prototype.curry(function(){setTimeout(t,e)})},fp.prototype.throttleDelay=function(t,e){return timeoutid=null,fp.prototype.curry(function(){null!=timeoutid&&clearTimeout(timeoutid),timeoutid=setTimeout(e,t)})},fp.prototype.throttle=fp.prototype.curry(function(t,e){return execute=!0,function(){var r=this,n=arguments;execute&&(e.apply(r,n),execute=!1,setTimeout(function(){execute=!0},t))}}),Spadmin.prototype.fp=new fp;var api=function(t){this.url=t,this.sandbox={},this.headers={},this.requestPre=[],this.requestPost=[]};api.prototype.headers={},api.prototype.beforeRequest=function(t){this.requestPre.push(t)},api.prototype.afterRequest=function(t){this.requestPost.push(t)},api.prototype.request=function(t,e,r,n){var o={method:t,url:e,payload:r,headers:n,api:this};"get"==t&&"string"==typeof r&&"?"==r[0]&&(e+=r);for(i in api.requestPre)api.requestPre[i](o);var p=this.getSandboxedUrl(t,e);if(p&&"string"!=typeof p)return p;e=p?p:e;var s=superagent[t](e);for(i in this.headers)s.set(i,this.headers[i]);for(i in n)s.set(i,n[i]);return"get"!=t&&s.send(r),new Promise(function(r,n){s.end(function(p,s){spadmin.bus.publish(t+"."+e.replace(/\?.*/g,"").replace(/\/[0-9]+$/,"/:id"),arguments);for(i in this.requestPost)this.requestPost[i](o,s,p);p?n(p,s):r(s.body)})})["catch"](function(t){throw t})},api.prototype.addEndpoint=function(t){var e=function(t,e){this.resourcename=t,this.api=e};e.prototype.getAll=function(t,e){return this.get(!1,t,e)},e.prototype.get=function(e,r,n){var i=this.api.url+"/"+t;return e&&(i+="/"+e),this.api.request("get",i,r,n,this.api)};var r=["post","put","options","patch"];r.map(function(r){e.prototype[r]=function(e,n,i){var o=this.api.url+"/"+t+"/"+e;return this.api.request(r,o,n,i)}}),this[t]=new e(t,this)},api.prototype.sandboxUrl=function(t,e){this.sandbox[t]=e},api.prototype.getSandboxedUrl=function(t,e){for(var r in this.sandbox){var n=this.sandbox[r],t=t.toUpperCase();if(null!=e.match(new RegExp(r,"g"))){if(n.path){var o=e.replace(/\/?\?.*/,"").replace(this.url,n.path)+"/"+t.toLowerCase()+".json";return console.log("sandboxed url: "+t+" "+e+" => "+o),o}if(n.data){console.log("sandboxed url: "+t+" "+e+" => {}");for(i in this.requestPost)this.requestPost[i](config,res,err);return new Promise(function(t,e){t(n.data)})}}}return!1},Spadmin.prototype.registerElement=function(t,e){for(i in e)"function"==typeof e[i]&&(e[i]={value:e[i]});var r={prototype:Object.create(HTMLElement.prototype,e)};return document.registerElement(t,r)},window.Spadmin=Spadmin,window.Nanobar=Nanobar;
