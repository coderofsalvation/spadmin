!function(t,e,n,r){"use strict";function i(t,e){for(var n=0,r=t.length;r>n;n++)y(t[n],e)}function o(t){for(var e,n=0,r=t.length;r>n;n++)e=t[n],_(e,F[a(e)])}function s(t){return function(e){rt(e)&&(y(e,t),i(e.querySelectorAll(U),t))}}function a(t){var e=t.getAttribute("is"),n=t.nodeName.toUpperCase(),r=I.call(H,e?P+e.toUpperCase():D+n);return e&&r>-1&&!u(n,e)?-1:r}function u(t,e){return-1<U.indexOf(t+'[is="'+e+'"]')}function c(t){var e=t.currentTarget,n=t.attrChange,r=t.attrName,i=t.target;mt&&(!i||i===e)&&e.attributeChangedCallback&&"style"!==r&&t.prevValue!==t.newValue&&e.attributeChangedCallback(r,n===t[O]?null:t.prevValue,n===t[q]?null:t.newValue)}function l(t){var e=s(t);return function(t){v.push(e,t.target)}}function h(t){dt&&(dt=!1,t.currentTarget.removeEventListener(k,h)),i((t.target||e).querySelectorAll(U),t.detail===A?A:C),nt&&d()}function p(t,e){var n=this;st.call(n,t,e),g.call(n,{target:n})}function f(t,e){Y(t,e),x?x.observe(t,ct):(ft&&(t.setAttribute=p,t[T]=w(t),t.addEventListener(j,g)),t.addEventListener(S,c)),t.createdCallback&&mt&&(t.created=!0,t.createdCallback(),t.created=!1)}function d(){for(var t,e=0,n=it.length;n>e;e++)t=it[e],V.contains(t)||(n--,it.splice(e--,1),y(t,A))}function m(t){throw new Error("A "+t+" type is already registered")}function y(t,e){var n,r=a(t);r>-1&&(E(t,F[r]),r=0,e!==C||t[C]?e===A&&!t[A]&&(t[C]=!1,t[A]=!0,r=1):(t[A]=!1,t[C]=!0,r=1,nt&&I.call(it,t)<0&&it.push(t)),r&&(n=t[e+"Callback"])&&n.call(t))}if(!(r in e)){var v,g,b,w,x,E,_,T="__"+r+(1e5*Math.random()>>0),C="attached",A="detached",N="extends",O="ADDITION",L="MODIFICATION",q="REMOVAL",S="DOMAttrModified",k="DOMContentLoaded",j="DOMSubtreeModified",D="<",P="=",M=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,R=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],H=[],F=[],U="",V=e.documentElement,I=H.indexOf||function(t){for(var e=this.length;e--&&this[e]!==t;);return e},$=n.prototype,B=$.hasOwnProperty,X=$.isPrototypeOf,z=n.defineProperty,Z=n.getOwnPropertyDescriptor,Q=n.getOwnPropertyNames,G=n.getPrototypeOf,K=n.setPrototypeOf,J=!!n.__proto__,W=n.create||function yt(t){return t?(yt.prototype=t,new yt):this},Y=K||(J?function(t,e){return t.__proto__=e,t}:Q&&Z?function(){function t(t,e){for(var n,r=Q(e),i=0,o=r.length;o>i;i++)n=r[i],B.call(t,n)||z(t,n,Z(e,n))}return function(e,n){do t(e,n);while((n=G(n))&&!X.call(n,e));return e}}():function(t,e){for(var n in e)t[n]=e[n];return t}),tt=t.MutationObserver||t.WebKitMutationObserver,et=(t.HTMLElement||t.Element||t.Node).prototype,nt=!X.call(et,V),rt=nt?function(t){return 1===t.nodeType}:function(t){return X.call(et,t)},it=nt&&[],ot=et.cloneNode,st=et.setAttribute,at=et.removeAttribute,ut=e.createElement,ct=tt&&{attributes:!0,characterData:!0,attributeOldValue:!0},lt=tt||function(t){ft=!1,V.removeEventListener(S,lt)},ht=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(t){setTimeout(t,10)},pt=!1,ft=!0,dt=!0,mt=!0;K||J?(E=function(t,e){X.call(e,t)||f(t,e)},_=f):(E=function(t,e){t[T]||(t[T]=n(!0),f(t,e))},_=E),nt?(ft=!1,function(){var t=Z(et,"addEventListener"),e=t.value,n=function(t){var e=new CustomEvent(S,{bubbles:!0});e.attrName=t,e.prevValue=this.getAttribute(t),e.newValue=null,e[q]=e.attrChange=2,at.call(this,t),this.dispatchEvent(e)},r=function(t,e){var n=this.hasAttribute(t),r=n&&this.getAttribute(t),i=new CustomEvent(S,{bubbles:!0});st.call(this,t,e),i.attrName=t,i.prevValue=n?r:null,i.newValue=e,n?i[L]=i.attrChange=1:i[O]=i.attrChange=0,this.dispatchEvent(i)},i=function(t){var e,n=t.currentTarget,r=n[T],i=t.propertyName;r.hasOwnProperty(i)&&(r=r[i],e=new CustomEvent(S,{bubbles:!0}),e.attrName=r.name,e.prevValue=r.value||null,e.newValue=r.value=n[i]||null,null==e.prevValue?e[O]=e.attrChange=0:e[L]=e.attrChange=1,n.dispatchEvent(e))};t.value=function(t,o,s){t===S&&this.attributeChangedCallback&&this.setAttribute!==r&&(this[T]={className:{name:"class",value:this.className}},this.setAttribute=r,this.removeAttribute=n,e.call(this,"propertychange",i)),e.call(this,t,o,s)},z(et,"addEventListener",t)}()):tt||(V.addEventListener(S,lt),V.setAttribute(T,1),V.removeAttribute(T),ft&&(g=function(t){var e,n,r,i=this;if(i===t.target){e=i[T],i[T]=n=w(i);for(r in n){if(!(r in e))return b(0,i,r,e[r],n[r],O);if(n[r]!==e[r])return b(1,i,r,e[r],n[r],L)}for(r in e)if(!(r in n))return b(2,i,r,e[r],n[r],q)}},b=function(t,e,n,r,i,o){var s={attrChange:t,currentTarget:e,attrName:n,prevValue:r,newValue:i};s[o]=t,c(s)},w=function(t){for(var e,n,r={},i=t.attributes,o=0,s=i.length;s>o;o++)e=i[o],n=e.name,"setAttribute"!==n&&(r[n]=e.value);return r})),e[r]=function(t,n){if(r=t.toUpperCase(),pt||(pt=!0,tt?(x=function(t,e){function n(t,e){for(var n=0,r=t.length;r>n;e(t[n++]));}return new tt(function(r){for(var i,o,s,a=0,u=r.length;u>a;a++)i=r[a],"childList"===i.type?(n(i.addedNodes,t),n(i.removedNodes,e)):(o=i.target,mt&&o.attributeChangedCallback&&"style"!==i.attributeName&&(s=o.getAttribute(i.attributeName),s!==i.oldValue&&o.attributeChangedCallback(i.attributeName,i.oldValue,s)))})}(s(C),s(A)),x.observe(e,{childList:!0,subtree:!0})):(v=[],ht(function g(){for(;v.length;)v.shift().call(null,v.shift());ht(g)}),e.addEventListener("DOMNodeInserted",l(C)),e.addEventListener("DOMNodeRemoved",l(A))),e.addEventListener(k,h),e.addEventListener("readystatechange",h),e.createElement=function(t,n){var r=ut.apply(e,arguments),i=""+t,o=I.call(H,(n?P:D)+(n||i).toUpperCase()),s=o>-1;return n&&(r.setAttribute("is",n=n.toLowerCase()),s&&(s=u(i.toUpperCase(),n))),mt=!e.createElement.innerHTMLHelper,s&&_(r,F[o]),r},et.cloneNode=function(t){var e=ot.call(this,!!t),n=a(e);return n>-1&&_(e,F[n]),t&&o(e.querySelectorAll(U)),e}),-2<I.call(H,P+r)+I.call(H,D+r)&&m(t),!M.test(r)||-1<I.call(R,r))throw new Error("The type "+t+" is invalid");var r,c,p=function(){return d?e.createElement(y,r):e.createElement(y)},f=n||$,d=B.call(f,N),y=d?n[N].toUpperCase():r;return d&&-1<I.call(H,D+y)&&m(y),c=H.push((d?P:D)+r)-1,U=U.concat(U.length?",":"",d?y+'[is="'+t.toLowerCase()+'"]':y),p.prototype=F[c]=B.call(f,"prototype")?f.prototype:W(et),i(e.querySelectorAll(U),C),p}}}(window,document,Object,"registerElement"),bus=function(t){this.opts=t||{},this.channels=[],this._state=t?t.defaultstate||"normal":"normal",this.debug=!1},bus.prototype.state=function(t){return t?(this._state=t,void this.publish("state",t)):this._state},bus.prototype.publish=function(t,e,n){n&&this.state(n),this.debug&&(console.log("--> bus.publish('"+t+"') state="+this._state),e&&console.dir(e));var r=this;(this.channels[t]||[]).map(function(t){t(e,r._state)})},bus.prototype.subscribe=function(t,e){return(this.channels[t]=this.channels[t]||[]).push(e),[t,e]},bus.prototype.unsubscribe=function(t){for(var e=this.channels[t[0]],n=e.length;n--;)e[n]===t[1]&&e.splice(n,1)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=bus:window.bus=bus,!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.page=t()}}(function(){return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){(function(n){"use strict";function r(t,e){if("function"==typeof t)return r("*",t);if("function"==typeof e)for(var n=new a(t),i=1;i<arguments.length;++i)r.callbacks.push(n.middleware(arguments[i]));else"string"==typeof t?r["string"==typeof e?"redirect":"show"](t,e):r.start(t)}function i(t){if(!t.handled){var e;e=b?g+m.hash.replace("#!",""):m.pathname+m.search,e!==t.canonicalPath&&(r.stop(),t.handled=!1,m.href=t.canonicalPath)}}function o(t){return"string"!=typeof t?t:v?decodeURIComponent(t.replace(/\+/g," ")):t}function s(t,e){"/"===t[0]&&0!==t.indexOf(g)&&(t=g+(b?"#!":"")+t);var n=t.indexOf("?");if(this.canonicalPath=t,this.path=t.replace(g,"")||"/",b&&(this.path=this.path.replace("#!","")||"/"),this.title=document.title,this.state=e||{},this.state.path=t,this.querystring=~n?o(t.slice(n+1)):"",this.pathname=o(~n?t.slice(0,n):t),this.params={},this.hash="",!b){if(!~this.path.indexOf("#"))return;var r=this.path.split("#");this.path=r[0],this.hash=o(r[1])||"",this.querystring=this.querystring.split("#")[0]}}function a(t,e){e=e||{},this.path="*"===t?"(.*)":t,this.method="GET",this.regexp=h(this.path,this.keys=[],e)}function u(t){if(1===c(t)&&!(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var e=t.path?t.path[0]:t.target;e&&"A"!==e.nodeName;)e=e.parentNode;if(e&&"A"===e.nodeName&&!e.hasAttribute("download")&&"external"!==e.getAttribute("rel")){var i=e.getAttribute("href");if((b||e.pathname!==m.pathname||!e.hash&&"#"!==i)&&!(i&&i.indexOf("mailto:")>-1)&&!e.target&&l(e.href)){var o=e.pathname+e.search+(e.hash||"");"undefined"!=typeof n&&o.match(/^\/[a-zA-Z]:\//)&&(o=o.replace(/^\/[a-zA-Z]:\//,"/"));var s=o;0===o.indexOf(g)&&(o=o.substr(g.length)),b&&(o=o.replace("#!","")),g&&s===o||(t.preventDefault(),r.show(s))}}}}function c(t){return t=t||window.event,null===t.which?t.button:t.which}function l(t){var e=m.protocol+"//"+m.hostname;return m.port&&(e+=":"+m.port),t&&0===t.indexOf(e)}var h=t("path-to-regexp");e.exports=r;var p,f,d="undefined"!=typeof document&&document.ontouchstart?"touchstart":"click",m="undefined"!=typeof window&&(window.history.location||window.location),y=!0,v=!0,g="",b=!1;r.callbacks=[],r.exits=[],r.current="",r.len=0,r.base=function(t){return 0===arguments.length?g:void(g=t)},r.start=function(t){if(t=t||{},!p&&(p=!0,!1===t.dispatch&&(y=!1),!1===t.decodeURLComponents&&(v=!1),!1!==t.popstate&&window.addEventListener("popstate",w,!1),!1!==t.click&&document.addEventListener(d,u,!1),!0===t.hashbang&&(b=!0),y)){var e=b&&~m.hash.indexOf("#!")?m.hash.substr(2)+m.search:m.pathname+m.search+m.hash;r.replace(e,null,!0,y)}},r.stop=function(){p&&(r.current="",r.len=0,p=!1,document.removeEventListener(d,u,!1),window.removeEventListener("popstate",w,!1))},r.show=function(t,e,n,i){var o=new s(t,e);return r.current=o.path,!1!==n&&r.dispatch(o),!1!==o.handled&&!1!==i&&o.pushState(),o},r.back=function(t,e){r.len>0?(history.back(),r.len--):t?setTimeout(function(){r.show(t,e)}):setTimeout(function(){r.show(g,e)})},r.redirect=function(t,e){"string"==typeof t&&"string"==typeof e&&r(t,function(t){setTimeout(function(){r.replace(e)},0)}),"string"==typeof t&&"undefined"==typeof e&&setTimeout(function(){r.replace(t)},0)},r.replace=function(t,e,n,i){var o=new s(t,e);return r.current=o.path,o.init=n,o.save(),!1!==i&&r.dispatch(o),o},r.dispatch=function(t){function e(){var t=r.exits[a++];return t?void t(o,e):n()}function n(){var e=r.callbacks[s++];return t.path!==r.current?void(t.handled=!1):e?void e(t,n):i(t)}var o=f,s=0,a=0;f=t,o?e():n()},r.exit=function(t,e){if("function"==typeof t)return r.exit("*",t);for(var n=new a(t),i=1;i<arguments.length;++i)r.exits.push(n.middleware(arguments[i]))},r.Context=s,s.prototype.pushState=function(){r.len++,history.pushState(this.state,this.title,b&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},s.prototype.save=function(){history.replaceState(this.state,this.title,b&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},r.Route=a,a.prototype.middleware=function(t){var e=this;return function(n,r){return e.match(n.path,n.params)?t(n,r):void r()}},a.prototype.match=function(t,e){var n=this.keys,r=t.indexOf("?"),i=~r?t.slice(0,r):t,s=this.regexp.exec(decodeURIComponent(i));if(!s)return!1;for(var a=1,u=s.length;u>a;++a){var c=n[a-1],l=o(s[a]);void 0===l&&hasOwnProperty.call(e,c.name)||(e[c.name]=l)}return!0};var w=function(){var t=!1;if("undefined"!=typeof window)return"complete"===document.readyState?t=!0:window.addEventListener("load",function(){setTimeout(function(){t=!0},0)}),function(e){if(t)if(e.state){var n=e.state.path;r.replace(n,e.state)}else r.show(m.pathname+m.hash,void 0,void 0,!1)}}();r.sameOrigin=l}).call(this,t("_process"))},{_process:2,"path-to-regexp":3}],2:[function(t,e,n){function r(){}var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};var r=[];if(e){var i=document.createElement("div"),o=new MutationObserver(function(){var t=r.slice();r.length=0,t.forEach(function(t){t()})});return o.observe(i,{attributes:!0}),function(t){r.length||i.setAttribute("yes","no"),r.push(t)}}return n?(window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],3:[function(t,e,n){function r(t){for(var e,n=[],r=0,i=0,o="";null!=(e=y.exec(t));){var s=e[0],u=e[1],c=e.index;if(o+=t.slice(i,c),i=c+s.length,u)o+=u[1];else{o&&(n.push(o),o="");var l=e[2],h=e[3],p=e[4],f=e[5],d=e[6],m=e[7],v="+"===d||"*"===d,g="?"===d||"*"===d,b=l||"/",w=p||f||(m?".*":"[^"+b+"]+?");n.push({name:h||r++,prefix:l||"",delimiter:b,optional:g,repeat:v,pattern:a(w)})}}return i<t.length&&(o+=t.substr(i)),o&&n.push(o),n}function i(t){return o(r(t))}function o(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^"+t[n].pattern+"$"));return function(n){for(var r="",i=n||{},o=0;o<t.length;o++){var s=t[o];if("string"!=typeof s){var a,u=i[s.name];if(null==u){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to be defined')}if(m(u)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received "'+u+'"');if(0===u.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var c=0;c<u.length;c++){if(a=encodeURIComponent(u[c]),!e[o].test(a))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received "'+a+'"');r+=(0===c?s.prefix:s.delimiter)+a}}else{if(a=encodeURIComponent(u),!e[o].test(a))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+a+'"');r+=s.prefix+a}}else r+=s}return r}}function s(t){return t.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function a(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function u(t,e){return t.keys=e,t}function c(t){return t.sensitive?"":"i"}function l(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return u(t,e)}function h(t,e,n){for(var r=[],i=0;i<t.length;i++)r.push(d(t[i],e,n).source);var o=new RegExp("(?:"+r.join("|")+")",c(n));return u(o,e)}function p(t,e,n){for(var i=r(t),o=f(i,n),s=0;s<i.length;s++)"string"!=typeof i[s]&&e.push(i[s]);return u(o,e)}function f(t,e){e=e||{};for(var n=e.strict,r=e.end!==!1,i="",o=t[t.length-1],a="string"==typeof o&&/\/$/.test(o),u=0;u<t.length;u++){var l=t[u];if("string"==typeof l)i+=s(l);else{var h=s(l.prefix),p=l.pattern;l.repeat&&(p+="(?:"+h+p+")*"),p=l.optional?h?"(?:"+h+"("+p+"))?":"("+p+")?":h+"("+p+")",i+=p}}return n||(i=(a?i.slice(0,-2):i)+"(?:\\/(?=$))?"),i+=r?"$":n&&a?"":"(?=\\/|$)",new RegExp("^"+i,c(e))}function d(t,e,n){return e=e||[],m(e)?n||(n={}):(n=e,e=[]),t instanceof RegExp?l(t,e,n):m(t)?h(t,e,n):p(t,e,n)}var m=t("isarray");e.exports=d,e.exports.parse=r,e.exports.compile=i,e.exports.tokensToFunction=o,e.exports.tokensToRegExp=f;var y=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},{isarray:4}],4:[function(t,e,n){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}]},{},[1])(1)}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.superagent=t()}}(function(){return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){function r(t){return null!==t&&"object"==typeof t}e.exports=r},{}],2:[function(t,e,n){var r=t("./is-object");n.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},n.parse=function(t){return this._parser=t,this},n.serialize=function(t){return this._serializer=t,this},n.timeout=function(t){return this._timeout=t,this},n.then=function(t,e){if(!this._fullfilledPromise){var n=this;this._fullfilledPromise=new Promise(function(t,e){n.end(function(n,r){n?e(n):t(r)})})}return this._fullfilledPromise.then(t,e)},n.use=function(t){return t(this),this},n.get=function(t){return this._header[t.toLowerCase()]},n.getHeader=n.get,n.set=function(t,e){if(r(t)){for(var n in t)this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},n.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},n.field=function(t,e){return this._getFormData().append(t,e),this},n.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},n.withCredentials=function(){return this._withCredentials=!0,this},n.redirects=function(t){return this._maxRedirects=t,this},n.toJSON=function(){return{method:this.method,url:this.url,data:this._data}},n._isHost=function(t){var e={}.toString.call(t);switch(e){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}},n.send=function(t){var e=r(t),n=this._header["content-type"];if(e&&r(this._data))for(var i in t)this._data[i]=t[i];else"string"==typeof t?(n||this.type("form"),n=this._header["content-type"],"application/x-www-form-urlencoded"==n?this._data=this._data?this._data+"&"+t:t:this._data=(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(n||this.type("json"),this)}},{"./is-object":1}],3:[function(t,e,n){function r(t,e,n){return"function"==typeof n?new t("GET",e).end(n):2==arguments.length?new t("GET",e):new t(e,n)}e.exports=r},{}],4:[function(t,e,n){function r(t){return t?i(t):void 0}function i(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}"undefined"!=typeof e&&(e.exports=r),r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===e||r.fn===e){n.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n){n=n.slice(0);for(var r=0,i=n.length;i>r;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],5:[function(t,e,n){e.exports=function(t,e,n){for(var r=0,i=t.length,o=3==arguments.length?n:t[r++];i>r;)o=e.call(null,o,t[r],++r,t);return o}},{}],6:[function(t,e,n){function r(){}function i(t){if(!g(t))return t;var e=[];for(var n in t)null!=t[n]&&o(e,n,t[n]);return e.join("&")}function o(t,e,n){if(Array.isArray(n))return n.forEach(function(n){o(t,e,n)});if(g(n))for(var r in n)o(t,e+"["+r+"]",n[r]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}function s(t){for(var e,n,r={},i=t.split("&"),o=0,s=i.length;s>o;++o)e=i[o],n=e.indexOf("="),-1==n?r[decodeURIComponent(e)]="":r[decodeURIComponent(e.slice(0,n))]=decodeURIComponent(e.slice(n+1));return r}function a(t){var e,n,r,i,o=t.split(/\r?\n/),s={};o.pop();for(var a=0,u=o.length;u>a;++a)n=o[a],e=n.indexOf(":"),r=n.slice(0,e).toLowerCase(),i=w(n.slice(e+1)),s[r]=i;return s}function u(t){return/[\/+]json\b/.test(t)}function c(t){return t.split(/ *; */).shift()}function l(t){return y(t.split(/ *; */),function(t,e){var n=e.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(t[r]=i),t},{})}function h(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function p(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new h(n)}catch(r){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=r,t.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,t.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(t)}if(n.emit("response",e),t)return n.callback(t,e);try{if(e.status>=200&&e.status<300)return n.callback(t,e);var i=new Error(e.statusText||"Unsuccessful HTTP response");i.original=t,i.response=e,i.status=e.status,n.callback(i,e)}catch(r){n.callback(r)}})}function f(t,e){var n=b("DELETE",t);return e&&n.end(e),n}var d,m=t("emitter"),y=t("reduce"),v=t("./request-base"),g=t("./is-object");d="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var b=e.exports=t("./request").bind(null,p);b.getXHR=function(){if(!(!d.XMLHttpRequest||d.location&&"file:"==d.location.protocol&&d.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1};var w="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};b.serializeObject=i,b.parseString=s,b.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},b.serialize={"application/x-www-form-urlencoded":i,"application/json":JSON.stringify},b.parse={"application/x-www-form-urlencoded":s,"application/json":JSON.parse},h.prototype.get=function(t){return this.header[t.toLowerCase()]},h.prototype._setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=c(e);var n=l(e);for(var r in n)this[r]=n[r]},h.prototype._parseBody=function(t){var e=b.parse[this.type];return!e&&u(this.type)&&(e=b.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null},h.prototype._setStatusProperties=function(t){1223===t&&(t=204);var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},h.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot "+e+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=e,i.url=n,i},b.Response=h,m(p.prototype);for(var x in v)p.prototype[x]=v[x];p.prototype.type=function(t){return this.set("Content-Type",b.types[t]||t),this},p.prototype.responseType=function(t){return this._responseType=t,this},p.prototype.accept=function(t){return this.set("Accept",b.types[t]||t),this},p.prototype.auth=function(t,e,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(t+":"+e);this.set("Authorization","Basic "+r);break;case"auto":this.username=t,this.password=e}return this},p.prototype.query=function(t){return"string"!=typeof t&&(t=i(t)),t&&this._query.push(t),this},p.prototype.attach=function(t,e,n){return this._getFormData().append(t,e,n||e.name),this},p.prototype._getFormData=function(){return this._formData||(this._formData=new d.FormData),this._formData},p.prototype.callback=function(t,e){var n=this._callback;this.clearTimeout(),n(t,e)},p.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},p.prototype._timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},p.prototype._appendQueryString=function(){var t=this._query.join("&");t&&(this.url+=~this.url.indexOf("?")?"&"+t:"?"+t)},p.prototype.end=function(t){var e=this,n=this.xhr=b.getXHR(),i=this._timeout,o=this._formData||this._data;this._callback=t||r,n.onreadystatechange=function(){if(4==n.readyState){var t;try{t=n.status}catch(r){t=0}if(0==t){if(e.timedout)return e._timeoutError();if(e._aborted)return;return e.crossDomainError()}e.emit("end")}};var s=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),t.direction="download",e.emit("progress",t)};this.hasListeners("progress")&&(n.onprogress=s);try{n.upload&&this.hasListeners("progress")&&(n.upload.onprogress=s)}catch(a){}if(i&&!this._timer&&(this._timer=setTimeout(function(){e.timedout=!0,e.abort()},i)),this._appendQueryString(),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof o&&!this._isHost(o)){var c=this._header["content-type"],l=this._serializer||b.serialize[c?c.split(";")[0]:""];!l&&u(c)&&(l=b.serialize["application/json"]),l&&(o=l(o))}for(var h in this.header)null!=this.header[h]&&n.setRequestHeader(h,this.header[h]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send("undefined"!=typeof o?o:null),this},b.Request=p,b.get=function(t,e,n){var r=b("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},b.head=function(t,e,n){var r=b("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},b.options=function(t,e,n){var r=b("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},b.del=f,b["delete"]=f,b.patch=function(t,e,n){var r=b("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},b.post=function(t,e,n){var r=b("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},b.put=function(t,e,n){var r=b("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}},{"./is-object":1,"./request":3,"./request-base":2,emitter:4,reduce:5}]},{},[6])(6)}),!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r,i,o,s,a,u=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};s=t("../lib/lodash.js"),a=t("./helpers"),i=t("./context"),o={},o.render=function(t,e,n,r){var u,c;return null==e&&(e=[]),null==n&&(n={}),null==r&&(r={}),c=r.debug&&console?a.consoleLogger:a.nullLogger,c("Transparency.render:",t,e,n,r),t?(s.isArray(e)||(e=[e]),t=(u=a.data(t)).context||(u.context=new i(t,o)),t.render(e,n,r).el):void 0},o.matcher=function(t,e){return t.el.id===e||u.call(t.classNames,e)>=0||t.el.name===e||t.el.getAttribute("data-bind")===e},o.clone=function(t){return r(t).clone()[0]},o.jQueryPlugin=a.chainable(function(t,e,n){var r,i,s,a;for(a=[],i=0,s=this.length;s>i;i++)r=this[i],a.push(o.render(r,t,e,n));return a}),("undefined"!=typeof jQuery&&null!==jQuery||"undefined"!=typeof Zepto&&null!==Zepto)&&(r=jQuery||Zepto,null!=r&&(r.fn.render=o.jQueryPlugin)),("undefined"!=typeof e&&null!==e?e.exports:void 0)&&(e.exports=o),"undefined"!=typeof window&&null!==window&&(window.Transparency=o),("undefined"!=typeof define&&null!==define?define.amd:void 0)&&define(function(){return o})},{"../lib/lodash.js":7,"./context":3,"./helpers":5}],2:[function(t,e,n){var r,i,o,s,a,u,c,l,h=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=t("../lib/lodash"),l=t("./helpers"),e.exports=i={Attributes:{},createAttribute:function(t,e){var n;return new(n=i.Attributes[e]||r)(t,e)}},r=function(){function t(t,e){this.el=t,this.name=e,this.templateValue=this.el.getAttribute(this.name)||""}return t.prototype.set=function(t){return this.el[this.name]=t,this.el.setAttribute(this.name,t.toString())},t}(),o=function(t){function e(t,e){this.el=t,this.name=e,this.templateValue=this.el.getAttribute(this.name)||!1}var n,r,o,s;for(h(e,t),n=["hidden","async","defer","autofocus","formnovalidate","disabled","autofocus","formnovalidate","multiple","readonly","required","checked","scoped","reversed","selected","loop","muted","autoplay","controls","seamless","default","ismap","novalidate","open","typemustmatch","truespeed"],r=0,o=n.length;o>r;r++)s=n[r],i.Attributes[s]=e;return e.prototype.set=function(t){return this.el[this.name]=t,t?this.el.setAttribute(this.name,this.name):this.el.removeAttribute(this.name)},e}(r),u=function(t){function e(t,e){var n;this.el=t,this.name=e,this.templateValue=function(){var t,e,r,i;for(r=this.el.childNodes,i=[],t=0,e=r.length;e>t;t++)n=r[t],n.nodeType===l.TEXT_NODE&&i.push(n.nodeValue);return i}.call(this).join(""),this.children=c.toArray(this.el.children),(this.textNode=this.el.firstChild)?this.textNode.nodeType!==l.TEXT_NODE&&(this.textNode=this.el.insertBefore(this.el.ownerDocument.createTextNode(""),this.textNode)):this.el.appendChild(this.textNode=this.el.ownerDocument.createTextNode(""))}return h(e,t),i.Attributes.text=e,e.prototype.set=function(t){for(var e,n,r,i,o;e=this.el.firstChild;)this.el.removeChild(e);for(this.textNode.nodeValue=t,this.el.appendChild(this.textNode),i=this.children,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.el.appendChild(e));return o},e}(r),a=function(t){function e(t){this.el=t,this.templateValue="",
this.children=c.toArray(this.el.children)}return h(e,t),i.Attributes.html=e,e.prototype.set=function(t){for(var e,n,r,i,o;e=this.el.firstChild;)this.el.removeChild(e);for(this.el.innerHTML=t+this.templateValue,i=this.children,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.el.appendChild(e));return o},e}(r),s=function(t){function e(t){e.__super__.constructor.call(this,t,"class")}return h(e,t),i.Attributes["class"]=e,e}(r)},{"../lib/lodash":7,"./helpers":5}],3:[function(t,e,n){var r,i,o,s,a,u,c;c=t("./helpers"),s=c.before,o=c.after,a=c.chainable,u=c.cloneNode,i=t("./instance"),e.exports=r=function(){function t(t,e){this.el=t,this.Transparency=e,this.template=u(this.el),this.instances=[new i(this.el,this.Transparency)],this.instanceCache=[]}var e,n;return n=a(function(){return this.parent=this.el.parentNode,this.parent?(this.nextSibling=this.el.nextSibling,this.parent.removeChild(this.el)):void 0}),e=a(function(){return this.parent?this.nextSibling?this.parent.insertBefore(this.el,this.nextSibling):this.parent.appendChild(this.el):void 0}),t.prototype.render=s(n)(o(e)(a(function(t,e,n){for(var r,o,s,a,c,l,h;t.length<this.instances.length;)this.instanceCache.push(this.instances.pop().remove());for(;t.length>this.instances.length;)a=this.instanceCache.pop()||new i(u(this.template),this.Transparency),this.instances.push(a.appendTo(this.el));for(h=[],s=o=0,c=t.length;c>o;s=++o)l=t[s],a=this.instances[s],r=[],h.push(a.prepare(l,r).renderValues(l,r).renderDirectives(l,s,e).renderChildren(l,r,e,n));return h}))),t}()},{"./helpers":5,"./instance":6}],4:[function(t,e,n){var r,i,o,s,a,u,c,l,h,p,f,d={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("../lib/lodash.js"),f=t("./helpers"),r=t("./attributeFactory"),e.exports=s={Elements:{input:{}},createElement:function(t){var e,n;return new(e="input"===(n=t.nodeName.toLowerCase())?s.Elements[n][t.type.toLowerCase()]||a:s.Elements[n]||o)(t)}},o=function(){function t(t){this.el=t,this.attributes={},this.childNodes=p.toArray(this.el.childNodes),this.nodeName=this.el.nodeName.toLowerCase(),this.classNames=this.el.className.split(" "),this.originalAttributes={}}return t.prototype.empty=function(){for(var t;t=this.el.firstChild;)this.el.removeChild(t);return this},t.prototype.reset=function(){var t,e,n,r;n=this.attributes,r=[];for(e in n)t=n[e],r.push(t.set(t.templateValue));return r},t.prototype.render=function(t){return this.attr("text",t)},t.prototype.attr=function(t,e){var n,i;return n=(i=this.attributes)[t]||(i[t]=r.createAttribute(this.el,t,e)),null!=e&&n.set(e),n},t.prototype.renderDirectives=function(t,e,n){var r,i,o,s;o=[];for(i in n)d.call(n,i)&&(r=n[i],"function"==typeof r&&(s=r.call(t,{element:this.el,index:e,value:this.attr(i).templateValue}),null!=s?o.push(this.attr(i,s)):o.push(void 0)));return o},t}(),c=function(t){function e(t){e.__super__.constructor.call(this,t),this.elements=f.getElements(t)}return m(e,t),s.Elements.select=e,e.prototype.render=function(t){var e,n,r,i,o;for(t=t.toString(),i=this.elements,o=[],e=0,n=i.length;n>e;e++)r=i[e],"option"===r.nodeName&&o.push(r.attr("selected",r.el.value===t));return o},e}(o),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var n,r,i,o;for(m(e,t),n=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],r=0,i=n.length;i>r;r++)o=n[r],s.Elements[o]=e;return e.prototype.attr=function(t,n){return"text"!==t&&"html"!==t?e.__super__.attr.call(this,t,n):void 0},e}(o),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.render=function(t){return this.attr("value",t)},e}(h),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),s.Elements.textarea=e,e}(a),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),s.Elements.input.checkbox=e,e.prototype.render=function(t){return this.attr("checked",Boolean(t))},e}(a),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),s.Elements.input.radio=e,e}(i)},{"../lib/lodash.js":7,"./attributeFactory":2,"./helpers":5}],5:[function(t,e,n){var r,i,o,s;r=t("./elementFactory"),n.before=function(t){return function(e){return function(){return t.apply(this,arguments),e.apply(this,arguments)}}},n.after=function(t){return function(e){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}},n.chainable=n.after(function(){return this}),n.onlyWith$=function(t){return"undefined"!=typeof jQuery&&null!==jQuery||"undefined"!=typeof Zepto&&null!==Zepto?function(e){return t(arguments)}(jQuery||Zepto):void 0},n.getElements=function(t){var e;return e=[],i(t,e),e},i=function(t,e){var o,s;for(o=t.firstChild,s=[];o;)o.nodeType===n.ELEMENT_NODE&&(e.push(new r.createElement(o)),i(o,e)),s.push(o=o.nextSibling);return s},n.ELEMENT_NODE=1,n.TEXT_NODE=3,s=function(){return"<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML},n.cloneNode="undefined"==typeof document||null===document||s()?function(t){return t.cloneNode(!0)}:function(t){var e,r,i,s,a;if(e=Transparency.clone(t),e.nodeType===n.ELEMENT_NODE)for(e.removeAttribute(o),a=e.getElementsByTagName("*"),i=0,s=a.length;s>i;i++)r=a[i],r.removeAttribute(o);return e},o="transparency",n.data=function(t){return t[o]||(t[o]={})},n.nullLogger=function(){},n.consoleLogger=function(){return console.log(arguments)},n.log=n.nullLogger},{"./elementFactory":4}],6:[function(t,e,n){var r,i,o,s,a={}.hasOwnProperty;i=t("../lib/lodash.js"),o=(s=t("./helpers")).chainable,e.exports=r=function(){function t(t,e){this.Transparency=e,this.queryCache={},this.childNodes=i.toArray(t.childNodes),this.elements=s.getElements(t)}return t.prototype.remove=o(function(){var t,e,n,r,i;for(r=this.childNodes,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(n.parentNode.removeChild(n));return i}),t.prototype.appendTo=o(function(t){var e,n,r,i,o;for(i=this.childNodes,o=[],e=0,n=i.length;n>e;e++)r=i[e],o.push(t.appendChild(r));return o}),t.prototype.prepare=o(function(t){var e,n,r,i,o;for(i=this.elements,o=[],n=0,r=i.length;r>n;n++)e=i[n],e.reset(),o.push(s.data(e.el).model=t);return o}),t.prototype.renderValues=o(function(t,e){var n,r,o,s;if(i.isElement(t)&&(n=this.elements[0]))return n.empty().el.appendChild(t);if("object"==typeof t){o=[];for(r in t)a.call(t,r)&&(s=t[r],null!=s&&(i.isString(s)||i.isNumber(s)||i.isBoolean(s)||i.isDate(s)?o.push(function(){var t,e,i,o;for(i=this.matchingElements(r),o=[],t=0,e=i.length;e>t;t++)n=i[t],o.push(n.render(s));return o}.call(this)):"object"==typeof s?o.push(e.push(r)):o.push(void 0)));return o}}),t.prototype.renderDirectives=o(function(t,e,n){var r,i,o,s;s=[];for(o in n)a.call(n,o)&&(r=n[o],"object"==typeof r&&("object"!=typeof t&&(t={value:t}),s.push(function(){var n,s,a,u;for(a=this.matchingElements(o),u=[],n=0,s=a.length;s>n;n++)i=a[n],u.push(i.renderDirectives(t,e,r));return u}.call(this))));return s}),t.prototype.renderChildren=o(function(t,e,n,r){var i,o,s,a,u;for(u=[],o=0,a=e.length;a>o;o++)s=e[o],u.push(function(){var e,o,a,u;for(a=this.matchingElements(s),u=[],e=0,o=a.length;o>e;e++)i=a[e],u.push(this.Transparency.render(i.el,t[s],n[s],r));return u}.call(this));return u}),t.prototype.matchingElements=function(t){var e,n,r;return r=(e=this.queryCache)[t]||(e[t]=function(){var e,r,i,o;for(i=this.elements,o=[],e=0,r=i.length;r>e;e++)n=i[e],this.Transparency.matcher(n,t)&&o.push(n);return o}.call(this)),s.log("Matching elements for '"+t+"':",r),r},t}()},{"../lib/lodash.js":7,"./helpers":5}],7:[function(t,e,n){var r={};r.toString=Object.prototype.toString,r.toArray=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n];return e},r.isString=function(t){return"[object String]"==r.toString.call(t)},r.isNumber=function(t){return"[object Number]"==r.toString.call(t)},r.isArray=Array.isArray||function(t){return"[object Array]"===r.toString.call(t)},r.isDate=function(t){return"[object Date]"===r.toString.call(t)},r.isElement=function(t){return!(!t||1!==t.nodeType)},r.isPlainValue=function(t){var e;return e=typeof t,"object"!==e&&"function"!==e||n.isDate(t)},r.isBoolean=function(t){return t===!0||t===!1},e.exports=r},{}]},{},[1]),function(t){"use strict";function e(){var t=document.getElementById("nanobarcss");if(null===t){if(t=document.createElement("style"),t.type="text/css",t.id="nanobarcss",document.head.insertBefore(t,document.head.firstChild),!t.styleSheet)return t.appendChild(document.createTextNode(o));t.styleSheet.cssText=o}}function n(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function r(t){function e(){var e=s-a;.1>e&&e>-.1?(r(a),u=0,100===s&&(o.style.height=0,setTimeout(function(){t(o)},300))):(r(s-e/4),setTimeout(i,16))}function r(t){s=t,o.style.width=s+"%"}function i(t){t>=0?(a=t,u||(u=1,e())):u&&e()}var o=document.createElement("div"),s=0,a=0,u=0,c={el:o,go:i};return n(o,"bar"),c}function i(t){function i(t){a.removeChild(t)}function o(){var t=r(i);a.appendChild(t.el),s=t.go}t=t||{};var s,a=document.createElement("div"),u={el:a,go:function(t){s(t),100===t&&o()}};return e(),n(a,"nanobar"),t.id&&(a.id=t.id),t.classname&&n(a,t.classname),t.target?(a.style.position="relative",t.target.insertBefore(a,t.target.firstChild)):(a.style.position="fixed",document.getElementsByTagName("body")[0].appendChild(a)),o(),u}var o=".nanobar{width:100%;height:4px;z-index:9999;top:0}.bar{width:0;height:100%;transition:height .3s;background:#000}";"object"==typeof exports?module.exports=i:"function"==typeof define&&define.amd?define([],function(){return i}):t.Nanobar=i}(this);var Spadmin=function(){console.log("*TODO* add typeshave"),this.channels={},this.page=page,this.template=Transparency,this.loader=new Nanobar,this.request=window.superagent};Spadmin.prototype.init=function(t){this.bus=new bus(t.defaultstate||"normal"),t.debug&&(this.bus.debug=!0),t.sandbox&&(this.sandbox=sandbox),this.bus.publish("init",arguments,"loading"),this.opts=t,this.pageid=t.content.replace(/^#/g,""),this.api=new api(t.apiurl,this),this.bus.publish("init/post",arguments)},Spadmin.prototype.renderPage=function(t,e){this.bus.publish("renderpage/pre",arguments),this.update(this.pageid,{show:!1}),this.render(t,e,this.pageid),this.update(this.pageid,{show:!0}),this.bus.publish("renderpage/post",arguments)},Spadmin.prototype.renderDOM=function(t,e,n,r){this.bus.publish("renderdom/pre",arguments);var i=t;if(n&&(i=document.getElementById(n),!i))throw"cannot find domid #"+n;this.template.render(t,e[0]||e,e[1]||{}),n&&(i.innerHTML=t.innerHTML),this.executeScripts(t),r&&r(t,arguments),this.bus.publish("renderdom/post",arguments)},Spadmin.prototype.executeScripts=function(el){for(var codes=el.getElementsByTagName("script"),i=0;i<codes.length;i++)codes[i].text&&eval(codes[i].text),codes[i].src&&this.loadScript(codes[i].src)},Spadmin.prototype.loadScript=function(t){this.bus.publish("loadscript",arguments);var e=document.createElement("script");e.src=t,e.async=!1,e.type="text/javascript",document.body.appendChild(e)},Spadmin.prototype.renderHTML=function(t,e){this.bus.publish("renderhtml/post",arguments);try{var n=document.createElement("div");return n.innerHTML=t.innerHTML,this.template.render(n,e[0]||e,e[1]||{}),this.bus.publish("renderhtml/post",n),n.innerHTML}catch(r){console.dir({args:arguments,func:"spadmin.renderHTML",error:r})}},Spadmin.prototype.render=function(t,e,n,r){this.bus.publish("render",arguments);try{var i=null!=t.match(/^http/)||null!=t.match(/\//),o=null!=t.match(/^#/);void 0!=n&&n.length&&(n=n.replace(/^#/,""));var s=this;if(o){var a=document.getElementById(t.replace(/^#/,""));this.renderDOM(a,e,n,r)}else i?superagent.get(t).end(function(t,i){if(t){if(String(t).match(/Error:/))throw t;return s.bus.publish("error",{type:"server",data:{err:t,res:i}})}var o=document.createElement("div");o.innerHTML=i.text,s.renderDOM(o,e,n,r)}):this.renderDOM(a,e,n,r)}catch(u){console.dir({args:arguments,func:"spadmin.render",error:u})}},Spadmin.prototype.update=function(t,e){this.bus.publish("update",arguments,"loading"),e&&void 0!=e.show&&(e.show===!1&&this.loader.go(50),e.show===!0&&this.loader.go(100)),this.bus.publish("update/post",arguments),this.bus.state(this.bus.opts.defaultstate)};var fp=function(){};fp.prototype.compose=function(){var t;t=1<=arguments.length?[].slice.call(arguments,0):[];var e=t.reverse().reduce(function(t,e){return function(){var n;return n=1<=arguments.length?[].slice.call(arguments,0):[],t(e.apply(null,n))}});return e},fp.prototype.ncurry=function(t,e,n){return null==n&&(n=[]),function(){var r;return r=1<=arguments.length?[].slice.call(arguments,0):[],r=n.concat(r),r.length<t?fp.prototype.ncurry(t,e,r):e.apply(null,r)}},fp.prototype.eq=function(t,e){return curry(function(t,e,n){return t==n||t==pick(e)(n)?n:void 0})(t)(e)},fp.prototype.curry=function(t){return me=this,function(){var e;return e=1<=arguments.length?[].slice.call(arguments,0):[],t.length>e.length?fp.prototype.ncurry(t.length,t,e):t.apply(null,e)}},fp.prototype.pick=fp.prototype.curry(function(t,e){return String(t).split(".").reduce(function(t,n){return null!=t?(fp.prototype.debug&&console.log("-- spadmin.fp.pick("+n+","+e+")"),t[n]):void 0},e)}),fp.prototype.createEventStream=function(t,e,n){var r="string"==typeof e?[e]:e,i=function(e){function n(t,n){n.map(function(n){t.addEventListener(n,e)})}var i,o;if("#"!==t[0]){var o=document.querySelectorAll(t);return Array.prototype.forEach.call(o,function(t){n(t,r)}),o}return(i=document.querySelector(t))?(n(i,r),i):void 0};return i},fp.prototype.mapAsync=function(t,e,n){var r,i,o,s,a;i=[],o=0;for(s in t)a=t[s],r=function(t,n){return function(){var r,o;try{return cb(n,t,i[t+1]||e)}catch(o){return r=o,e(new Error(r))}}},i.push(r(o++,a));return i[0]()},fp.prototype.delay=function(t,e){return fp.prototype.curry(function(){setTimeout(t,e)})},fp.prototype.throttleDelay=function(t,e){return timeoutid=null,fp.prototype.curry(function(){null!=timeoutid&&clearTimeout(timeoutid),timeoutid=setTimeout(e,t)})},fp.prototype.throttle=fp.prototype.curry(function(t,e){return execute=!0,function(){var n=this,r=arguments;execute&&(e.apply(n,r),execute=!1,setTimeout(function(){execute=!0},t))}}),Spadmin.prototype.fp=new fp;var api=function(t){this.url=t,this.sandbox={},this.headers={},this.requestPre=[],this.requestPost=[]};api.prototype.headers={},api.prototype.beforeRequest=function(t){this.requestPre.push(t)},api.prototype.afterRequest=function(t){this.requestPost.push(t)},api.prototype.request=function(t,e,n,r){var o={method:t,url:e,payload:n,headers:r,api:this};"get"==t&&"string"==typeof n&&"?"==n[0]&&(e+=n);for(i in api.requestPre)api.requestPre[i](o);var s=this.getSandboxedUrl(t,e);if(s&&"string"!=typeof s)return s;e=s?s:e;var a=superagent[t](e);for(i in this.headers)a.set(i,this.headers[i]);for(i in r)a.set(i,r[i]);return"get"!=t&&a.send(n),new Promise(function(n,r){a.end(function(s,a){spadmin.bus.publish(t+"."+e.replace(/\?.*/g,"").replace(/\/[0-9]+$/,"/:id"),arguments);for(i in this.requestPost)this.requestPost[i](o,a,s);s?r(s,a):n(a.body)})})["catch"](function(t){throw t})},api.prototype.addEndpoint=function(t){var e=function(t,e){this.resourcename=t,this.api=e};e.prototype.getAll=function(t,e){return this.get(!1,t,e)},e.prototype.get=function(e,n,r){var i=this.api.url+"/"+t;return e&&(i+="/"+e),this.api.request("get",i,n,r,this.api)};var n=["post","put","options","patch"];n.map(function(n){e.prototype[n]=function(e,r,i){var o=this.api.url+"/"+t+"/"+e;return this.api.request(n,o,r,i)}}),this[t]=new e(t,this)},api.prototype.sandboxUrl=function(t,e){this.sandbox[t]=e},api.prototype.getSandboxedUrl=function(t,e){var n={method:t,url:e,payload:{},headers:this.headers,api:this};for(var r in this.sandbox){var o=this.sandbox[r],t=t.toUpperCase();if(null!=e.match(new RegExp(r,"g"))){if(o.path){var s=e.replace(/\/?\?.*/,"").replace(this.url,o.path)+"/"+t.toLowerCase()+".json";return console.log("sandboxed url: "+t+" "+e+" => "+s),s}if(o.data){console.log("sandboxed url: "+t+" "+e+" => {}");var a={body:o.data};for(i in this.requestPost)this.requestPost[i](n,a);return new Promise(function(t,e){t(a.body)})}}}return!1},Spadmin.prototype.registerElement=function(t,e){for(i in e)"function"==typeof e[i]&&(e[i]={value:e[i]});var n={prototype:Object.create(HTMLElement.prototype,e)};return document.registerElement(t,n)},window.Spadmin=Spadmin,window.Nanobar=Nanobar;
